var AlkkagiSharedBundle=(()=>{var F=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var H=Object.getOwnPropertyNames;var W=Object.prototype.hasOwnProperty;var j=(r,t,e)=>t in r?F(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var q=(r,t)=>{for(var e in t)F(r,e,{get:t[e],enumerable:!0})},K=(r,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of H(t))!W.call(r,o)&&o!==e&&F(r,o,{get:()=>t[o],enumerable:!(i=G(t,o))||i.enumerable});return r};var J=r=>K(F({},"__esModule",{value:!0}),r);var m=(r,t,e)=>j(r,typeof t!="symbol"?t+"":t,e);var Y={};q(Y,{BufferReadHandle:()=>x,BufferWriteHandle:()=>g,ELogLevel:()=>E,ELogMode:()=>b,EPacketID:()=>d,MessagePacket:()=>U,Packet:()=>u,PacketHandler:()=>p,PacketManager:()=>w,SerializableData:()=>c,Vector:()=>l,VectorPacket:()=>y,decodeUTF16LE:()=>T,decodeUTF8:()=>O,encodeUTF16LE:()=>L,encodeUTF8:()=>D,getBytesHeaderSize:()=>I,getFlexiableUTF16LESize:()=>Q,getFlexiableUTF8Size:()=>A,logger:()=>X});function D(r){if(typeof TextEncoder!="undefined")return new TextEncoder().encode(r);let t=[];for(let e=0;e<r.length;e++){let i=r.charCodeAt(e);if(i>=55296&&i<=56319&&e+1<r.length){let o=r.charCodeAt(e+1);o>=56320&&o<=57343&&(i=65536+(i-55296<<10)+(o-56320),e++)}i<=127?t.push(i):i<=2047?t.push(192|i>>6,128|i&63):i<=65535?t.push(224|i>>12,128|i>>6&63,128|i&63):t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}return Uint8Array.from(t)}function O(r){var e,i,o,f,s,h;if(typeof TextDecoder!="undefined")return new TextDecoder("utf-8").decode(r);let t="";for(let n=0;n<r.length;){let a=r[n++];if(a<128){t+=String.fromCharCode(a);continue}if((a&224)===192){let S=((e=r[n++])!=null?e:0)&63,z=(a&31)<<6|S;t+=String.fromCharCode(z);continue}if((a&240)===224){let S=((i=r[n++])!=null?i:0)&63,z=((o=r[n++])!=null?o:0)&63,V=(a&15)<<12|S<<6|z;t+=String.fromCharCode(V);continue}let M=((f=r[n++])!=null?f:0)&63,P=((s=r[n++])!=null?s:0)&63,N=((h=r[n++])!=null?h:0)&63,R=(a&7)<<18|M<<12|P<<6|N,k=55296+(R-65536>>10),$=56320+(R-65536&1023);t+=String.fromCharCode(k,$)}return t}function L(r,t=!1){let e=[];for(let s=0;s<r.length;s++){let h=r.charCodeAt(s);if(h>=55296&&h<=56319&&s+1<r.length){let n=r.charCodeAt(s+1);if(n>=56320&&n<=57343){e.push(h,n),s++;continue}}e.push(h)}let i=t?2:0,o=new Uint8Array(e.length*2+i),f=0;t&&(o[f++]=255,o[f++]=254);for(let s=0;s<e.length;s++){let h=e[s];o[f++]=h&255,o[f++]=h>>8}return o}function T(r){let t=0;r.length>=2&&r[0]===255&&r[1]===254&&(t=2);let e=32768,i=r.length-t>>>1,o="";for(let f=0;f<i;f+=e){let s=Math.min(e,i-f),h=new Array(s);for(let n=0;n<s;n++)h[n]=r[t+(f+n<<1)]|r[t+(f+n<<1)+1]<<8;o+=String.fromCharCode(...h)}return o}var x=class{constructor(t){this.buffer=t,this.view=new DataView(t),this.offset=0}readUint8(){if(this.offset+1>this.buffer.byteLength)throw new Error("Error with readUint8: Out of bounds");let t=this.view.getUint8(this.offset);return this.offset+=1,t}readUint16(){if(this.offset+2>this.buffer.byteLength)throw new Error("Error with readUint16: Out of bounds");let t=this.view.getUint16(this.offset,!0);return this.offset+=2,t}readUint32(){if(this.offset+4>this.buffer.byteLength)throw new Error("Error with readUint32: Out of bounds");let t=this.view.getUint32(this.offset,!0);return this.offset+=4,t}readInt8(){if(this.offset+1>this.buffer.byteLength)throw new Error("Error with readInt8: Out of bounds");let t=this.view.getInt8(this.offset);return this.offset+=1,t}readInt16(){if(this.offset+2>this.buffer.byteLength)throw new Error("Error with readInt16: Out of bounds");let t=this.view.getInt16(this.offset,!0);return this.offset+=2,t}readInt32(){if(this.offset+4>this.buffer.byteLength)throw new Error("Error with readInt32: Out of bounds");let t=this.view.getInt32(this.offset,!0);return this.offset+=4,t}readFloat32(){if(this.offset+4>this.buffer.byteLength)throw new Error("Error with readFloat32: Out of bounds");let t=this.view.getFloat32(this.offset,!0);return this.offset+=4,t}readFloat64(){if(this.offset+8>this.buffer.byteLength)throw new Error("Error with readFloat64: Out of bounds");let t=this.view.getFloat64(this.offset,!0);return this.offset+=8,t}readStringUTF8(){let t=this.readUint16();if(this.offset+t>this.buffer.byteLength)throw new Error("Error with readStringUTF8: Out of bounds");let e=new Uint8Array(this.buffer,this.offset,t),i=O(e);return this.offset+=t,i}readStringUTF16LE(){let t=this.readUint16();if(this.offset+t>this.buffer.byteLength)throw new Error("Error with readStringUTF16LE: Out of bounds");let e=new Uint8Array(this.buffer,this.offset,t),i=T(e);return this.offset+=t,i}readBytes(){return new Uint8Array(this.readArrayBuffer())}readArrayBuffer(){let t=this.readUint16();if(this.offset+t>this.buffer.byteLength)throw new Error("Error with readArrayBuffer: Out of bounds");let e=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,e}},g=class{constructor(t){this.buffer=t,this.view=new DataView(t),this.offset=0}writeUint8(t){if(this.offset+1>this.buffer.byteLength)throw new Error("Error with writeUint8: Out of bounds");this.view.setUint8(this.offset,t),this.offset+=1}writeUint16(t){if(this.offset+2>this.buffer.byteLength)throw new Error("Error with writeUint16: Out of bounds");this.view.setUint16(this.offset,t,!0),this.offset+=2}writeUint32(t){if(this.offset+4>this.buffer.byteLength)throw new Error("Error with writeUint32: Out of bounds");this.view.setUint32(this.offset,t,!0),this.offset+=4}writeInt8(t){if(this.offset+1>this.buffer.byteLength)throw new Error("Error with writeInt8: Out of bounds");this.view.setInt8(this.offset,t),this.offset+=1}writeInt16(t){if(this.offset+2>this.buffer.byteLength)throw new Error("Error with writeInt16: Out of bounds");this.view.setInt16(this.offset,t,!0),this.offset+=2}writeInt32(t){if(this.offset+4>this.buffer.byteLength)throw new Error("Error with writeInt32: Out of bounds");this.view.setInt32(this.offset,t,!0),this.offset+=4}writeFloat32(t){if(this.offset+4>this.buffer.byteLength)throw new Error("Error with writeFloat32: Out of bounds");this.view.setFloat32(this.offset,t,!0),this.offset+=4}writeFloat64(t){if(this.offset+8>this.buffer.byteLength)throw new Error("Error with writeFloat64: Out of bounds");this.view.setFloat64(this.offset,t,!0),this.offset+=8}writeStringUTF8(t){let e=D(t),i=e.length;if(i>65535)throw new Error("Error with writeStringUTF8: Out of bounds");if(this.offset+2+i>this.buffer.byteLength)throw new Error("Error with writeStringUTF8: Out of bounds");this.writeUint16(i),new Uint8Array(this.buffer,this.offset,i).set(e),this.offset+=i}writeStringUTF16LE(t){let e=L(t,!1),i=e.length;if(i>65535)throw new Error("Error with writeStringUTF16LE: Out of bounds");if(this.offset+2+i>this.buffer.byteLength)throw new Error("Error with writeStringUTF16LE: Out of bounds");this.writeUint16(i),new Uint8Array(this.buffer,this.offset,i).set(e),this.offset+=i}writeBytes(t){let e=t.length;if(this.offset+e>this.buffer.byteLength)throw new Error("Error with writeBytes: Out of bounds");this.writeUint16(e),new Uint8Array(this.buffer,this.offset,e).set(t),this.offset+=e}writeArrayBuffer(t){let e=new Uint8Array(t);this.writeBytes(e)}build(){return this.buffer.slice(0,this.offset)}};function A(r){return 2+r.length*4}function Q(r){return 2+r.length*4}function I(){return 2}var B={ERROR:"\x1B[31m",WARN:"\x1B[33m",INFO:"\x1B[36m",DEBUG:"\x1B[90m",RESET:"\x1B[0m"},E={ERROR:0,WARN:1,INFO:2,DEBUG:3},b={DEVELOPMENT:"development",PRODUCTION:"production",MASTER:"master"},v={[b.DEVELOPMENT]:E.DEBUG,[b.PRODUCTION]:E.INFO,[b.MASTER]:E.ERROR},C=class{constructor(){this.currentLevel=v[b.DEVELOPMENT]}setMode(t){v.hasOwnProperty(t)!==!1&&(this.currentLevel=v[t])}getTimestamp(){return new Date().toISOString()}formatMessage(t,e,i){let o=this.getTimestamp(),f=B[t]||"",s=B.RESET;return`${f}[${o}] [${t}] [${e}] ${i}${s}`}log(t,e,i){E[t]>this.currentLevel||console.log(this.formatMessage(t,e,i))}error(t,e){this.log("ERROR",t,e)}warn(t,e){this.log("WARN",t,e)}info(t,e){this.log("INFO",t,e)}debug(t,e){this.log("DEBUG",t,e)}},X=new C;var c=class{constructor(){}getFlexiableSize(){throw new Error("Abstract method 'getFlexiableSize' must be implemented")}serialize(){let t=new ArrayBuffer(this.getFlexiableSize()),e=new g(t);return this.onSerialize(e),e.build()}onSerialize(t){throw new Error("Abstract method 'onSerialize' must be implemented")}deserialize(t){let e=new x(t);return this.onDeserialize(e),this}onDeserialize(t){throw new Error("Abstract method 'onDeserialize' must be implemented")}};var l=class r extends c{constructor(t=0,e=0){super(),this.x=t,this.y=e}getFlexiableSize(){let t=0;return t+=4,t+=4,t}onSerialize(t){t.writeFloat32(this.x),t.writeFloat32(this.y)}onDeserialize(t){this.x=t.readFloat32(),this.y=t.readFloat32()}getMagnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}getSqrMagnitude(){return this.x*this.x+this.y*this.y}getNormalized(){let t=this.getMagnitude();return t===0?new r(0,0):new r(this.x/t,this.y/t)}normalize(){let t=this.getMagnitude();t!==0&&(this.x/=t,this.y/=t)}getAdded(t){return new r(this.x+t.x,this.y+t.y)}add(t){this.x+=t.x,this.y+=t.y}getSubtracted(t){return new r(this.x-t.x,this.y-t.y)}subtract(t){this.x-=t.x,this.y-=t.y}getMultiplied(t){return new r(this.x*t,this.y*t)}multiply(t){this.x*=t,this.y*=t}getDivided(t){return new r(this.x/t,this.y/t)}divide(t){this.x/=t,this.y/=t}};var u=class extends c{constructor(){super()}getPacketID(){throw new Error("Abstract method 'getPacketID' must be implemented")}getFlexiableSize(){let t=0;return t+=1,t}onSerialize(t){t.writeUint8(this.getPacketID())}onDeserialize(t){t.readUint8()}};var p=class{constructor(){}handle(t){throw new Error("Abstract method 'handle' must be implemented")}};var w=class{constructor(){throw new Error("PacketManager is a static class and cannot be instantiated")}static on(t,e,i){this.factories[t]=e,this.handlers[t]=i}static createPacket(t,e){let i=this.factories[t];if(i===void 0)throw new Error(`Factory for packetID ${t} not found`);let o=new i;return o.deserialize(e),o}static createHandler(t,...e){let i=this.handlers[t];if(i===void 0)throw new Error(`Handler for packetID ${t} not found`);return new i(...this.handlerArgs,...e)}static injectHandlerArgs(...t){this.handlerArgs=t}};m(w,"factories",{}),m(w,"handlers",{}),m(w,"handlerArgs",[]);var d={MESSAGE:0,VECTOR:1};var U=class extends u{constructor(t=""){super(),this.message=t}getPacketID(){return d.MESSAGE}getFlexiableSize(){let t=super.getFlexiableSize();return t+=A(this.message),t}onSerialize(t){super.onSerialize(t),t.writeStringUTF8(this.message)}onDeserialize(t){super.onDeserialize(t),this.message=t.readStringUTF8()}};var y=class extends u{constructor(t=new l){super(),this.vector=t}getPacketID(){return d.VECTOR}getFlexiableSize(){let t=super.getFlexiableSize();return t+=this.vector.getFlexiableSize()+I(),t}onSerialize(t){super.onSerialize(t),t.writeArrayBuffer(this.vector.serialize())}onDeserialize(t){super.onDeserialize(t),this.vector=new l().deserialize(t.readArrayBuffer())}};return J(Y);})();
//# sourceMappingURL=SharedBundle.js.map
