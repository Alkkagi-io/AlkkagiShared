var AlkkagiSharedBundle=(()=>{var V=Object.defineProperty;var St=Object.getOwnPropertyDescriptor;var wt=Object.getOwnPropertyNames;var zt=Object.prototype.hasOwnProperty;var bt=(i,t,e)=>t in i?V(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var Ft=(i,t)=>{for(var e in t)V(i,e,{get:t[e],enumerable:!0})},Ut=(i,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of wt(t))!zt.call(i,s)&&s!==e&&V(i,s,{get:()=>t[s],enumerable:!(r=St(t,s))||r.enumerable});return i};var It=i=>Ut(V({},"__esModule",{value:!0}),i);var b=(i,t,e)=>bt(i,typeof t!="symbol"?t+"":t,e);var Lt={};Ft(Lt,{BufferReadHandle:()=>O,BufferWriteHandle:()=>k,C2S_BuyItemPacket:()=>W,C2S_CharacterStatLevelUpRequestPacket:()=>et,C2S_EnterWorldRequestPacket:()=>j,C2S_FinishAttackChargingPacket:()=>Q,C2S_MoveInputPacket:()=>J,C2S_StartAttackChargingPacket:()=>Z,CharacterEntityDynamicData:()=>d,CharacterEntityStaticData:()=>U,DamagableEntityDynamicData:()=>D,EEntityType:()=>c,ELogLevel:()=>_,ELogMode:()=>v,EMoveInput:()=>N,EPacketID:()=>f,EStatLevelUpType:()=>x,EntityDataFactory:()=>p,EntityDynamicData:()=>A,EntityStaticData:()=>S,MessagePacket:()=>X,Packet:()=>h,PacketHandler:()=>G,PacketManager:()=>I,PlayerEntityDynamicData:()=>L,Random:()=>ut,ResourceBase:()=>y,ResourceCharacterLevel:()=>ct,ResourceShopItem:()=>pt,ResourceStatLevelUp:()=>lt,S2C_CharacterLevelUpPacket:()=>Y,S2C_CharacterStatLevelUpResponsePacket:()=>H,S2C_EnterWorldResponsePacket:()=>K,S2C_UpdateRankingPacket:()=>tt,S2C_UpdateWorldPacket:()=>$,SerializableData:()=>E,StaticEntityStaticData:()=>w,Vector:()=>l,VectorPacket:()=>q,decodeUTF16LE:()=>at,decodeUTF8:()=>ot,encodeUTF16LE:()=>nt,encodeUTF8:()=>st,getBytesHeaderSize:()=>g,getFlexiableUTF16LESize:()=>Pt,getFlexiableUTF8Size:()=>F,logger:()=>Tt,parseToBoolean:()=>B,parseToFloat:()=>M,parseToInteger:()=>R});function st(i){if(typeof TextEncoder!="undefined")return new TextEncoder().encode(i);let t=[];for(let e=0;e<i.length;e++){let r=i.charCodeAt(e);if(r>=55296&&r<=56319&&e+1<i.length){let s=i.charCodeAt(e+1);s>=56320&&s<=57343&&(r=65536+(r-55296<<10)+(s-56320),e++)}r<=127?t.push(r):r<=2047?t.push(192|r>>6,128|r&63):r<=65535?t.push(224|r>>12,128|r>>6&63,128|r&63):t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}return Uint8Array.from(t)}function ot(i){var e,r,s,o,n,a;if(typeof TextDecoder!="undefined")return new TextDecoder("utf-8").decode(i);let t="";for(let u=0;u<i.length;){let m=i[u++];if(m<128){t+=String.fromCharCode(m);continue}if((m&224)===192){let rt=((e=i[u++])!=null?e:0)&63,it=(m&31)<<6|rt;t+=String.fromCharCode(it);continue}if((m&240)===224){let rt=((r=i[u++])!=null?r:0)&63,it=((s=i[u++])!=null?s:0)&63,dt=(m&15)<<12|rt<<6|it;t+=String.fromCharCode(dt);continue}let C=((o=i[u++])!=null?o:0)&63,xt=((n=i[u++])!=null?n:0)&63,Et=((a=i[u++])!=null?a:0)&63,mt=(m&7)<<18|C<<12|xt<<6|Et,Dt=55296+(mt-65536>>10),yt=56320+(mt-65536&1023);t+=String.fromCharCode(Dt,yt)}return t}function nt(i,t=!1){let e=[];for(let n=0;n<i.length;n++){let a=i.charCodeAt(n);if(a>=55296&&a<=56319&&n+1<i.length){let u=i.charCodeAt(n+1);if(u>=56320&&u<=57343){e.push(a,u),n++;continue}}e.push(a)}let r=t?2:0,s=new Uint8Array(e.length*2+r),o=0;t&&(s[o++]=255,s[o++]=254);for(let n=0;n<e.length;n++){let a=e[n];s[o++]=a&255,s[o++]=a>>8}return s}function at(i){let t=0;i.length>=2&&i[0]===255&&i[1]===254&&(t=2);let e=32768,r=i.length-t>>>1,s="";for(let o=0;o<r;o+=e){let n=Math.min(e,r-o),a=new Array(n);for(let u=0;u<n;u++)a[u]=i[t+(o+u<<1)]|i[t+(o+u<<1)+1]<<8;s+=String.fromCharCode(...a)}return s}var O=class{constructor(t){this.buffer=t,this.view=new DataView(t),this.offset=0}readUint8(){if(this.offset+1>this.buffer.byteLength)throw new Error("Error with readUint8: Out of bounds");let t=this.view.getUint8(this.offset);return this.offset+=1,t}readUint16(){if(this.offset+2>this.buffer.byteLength)throw new Error("Error with readUint16: Out of bounds");let t=this.view.getUint16(this.offset,!0);return this.offset+=2,t}readUint32(){if(this.offset+4>this.buffer.byteLength)throw new Error("Error with readUint32: Out of bounds");let t=this.view.getUint32(this.offset,!0);return this.offset+=4,t}readInt8(){if(this.offset+1>this.buffer.byteLength)throw new Error("Error with readInt8: Out of bounds");let t=this.view.getInt8(this.offset);return this.offset+=1,t}readInt16(){if(this.offset+2>this.buffer.byteLength)throw new Error("Error with readInt16: Out of bounds");let t=this.view.getInt16(this.offset,!0);return this.offset+=2,t}readInt32(){if(this.offset+4>this.buffer.byteLength)throw new Error("Error with readInt32: Out of bounds");let t=this.view.getInt32(this.offset,!0);return this.offset+=4,t}readFloat32(){if(this.offset+4>this.buffer.byteLength)throw new Error("Error with readFloat32: Out of bounds");let t=this.view.getFloat32(this.offset,!0);return this.offset+=4,t}readFloat64(){if(this.offset+8>this.buffer.byteLength)throw new Error("Error with readFloat64: Out of bounds");let t=this.view.getFloat64(this.offset,!0);return this.offset+=8,t}readStringUTF8(){let t=this.readUint16();if(this.offset+t>this.buffer.byteLength)throw new Error("Error with readStringUTF8: Out of bounds");let e=new Uint8Array(this.buffer,this.offset,t),r=ot(e);return this.offset+=t,r}readStringUTF16LE(){let t=this.readUint16();if(this.offset+t>this.buffer.byteLength)throw new Error("Error with readStringUTF16LE: Out of bounds");let e=new Uint8Array(this.buffer,this.offset,t),r=at(e);return this.offset+=t,r}readBytes(){return new Uint8Array(this.readArrayBuffer())}readArrayBuffer(){let t=this.readUint16();if(this.offset+t>this.buffer.byteLength)throw new Error("Error with readArrayBuffer: Out of bounds");let e=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,e}},k=class{constructor(t){this.buffer=t,this.view=new DataView(t),this.offset=0}writeUint8(t){if(this.offset+1>this.buffer.byteLength)throw new Error("Error with writeUint8: Out of bounds");this.view.setUint8(this.offset,t),this.offset+=1}writeUint16(t){if(this.offset+2>this.buffer.byteLength)throw new Error("Error with writeUint16: Out of bounds");this.view.setUint16(this.offset,t,!0),this.offset+=2}writeUint32(t){if(this.offset+4>this.buffer.byteLength)throw new Error("Error with writeUint32: Out of bounds");this.view.setUint32(this.offset,t,!0),this.offset+=4}writeInt8(t){if(this.offset+1>this.buffer.byteLength)throw new Error("Error with writeInt8: Out of bounds");this.view.setInt8(this.offset,t),this.offset+=1}writeInt16(t){if(this.offset+2>this.buffer.byteLength)throw new Error("Error with writeInt16: Out of bounds");this.view.setInt16(this.offset,t,!0),this.offset+=2}writeInt32(t){if(this.offset+4>this.buffer.byteLength)throw new Error("Error with writeInt32: Out of bounds");this.view.setInt32(this.offset,t,!0),this.offset+=4}writeFloat32(t){if(this.offset+4>this.buffer.byteLength)throw new Error("Error with writeFloat32: Out of bounds");this.view.setFloat32(this.offset,t,!0),this.offset+=4}writeFloat64(t){if(this.offset+8>this.buffer.byteLength)throw new Error("Error with writeFloat64: Out of bounds");this.view.setFloat64(this.offset,t,!0),this.offset+=8}writeStringUTF8(t){let e=st(t),r=e.length;if(r>65535)throw new Error("Error with writeStringUTF8: Out of bounds");if(this.offset+2+r>this.buffer.byteLength)throw new Error("Error with writeStringUTF8: Out of bounds");this.writeUint16(r),new Uint8Array(this.buffer,this.offset,r).set(e),this.offset+=r}writeStringUTF16LE(t){let e=nt(t,!1),r=e.length;if(r>65535)throw new Error("Error with writeStringUTF16LE: Out of bounds");if(this.offset+2+r>this.buffer.byteLength)throw new Error("Error with writeStringUTF16LE: Out of bounds");this.writeUint16(r),new Uint8Array(this.buffer,this.offset,r).set(e),this.offset+=r}writeBytes(t){let e=t.length;if(this.offset+e>this.buffer.byteLength)throw new Error("Error with writeBytes: Out of bounds");this.writeUint16(e),new Uint8Array(this.buffer,this.offset,e).set(t),this.offset+=e}writeArrayBuffer(t){let e=new Uint8Array(t);this.writeBytes(e)}build(){return this.buffer.slice(0,this.offset)}};function F(i){return 2+i.length*4}function Pt(i){return 2+i.length*4}function g(){return 2}var E=class{constructor(){}getFlexibleSize(){throw new Error("Abstract method 'getFlexiableSize' must be implemented")}serialize(){let t=new ArrayBuffer(this.getFlexibleSize()),e=new k(t);return this.onSerialize(e),e.build()}onSerialize(t){throw new Error("Abstract method 'onSerialize' must be implemented")}deserialize(t){let e=new O(t);return this.onDeserialize(e),this}onDeserialize(t){throw new Error("Abstract method 'onDeserialize' must be implemented")}};var c={None:0,XPObject:1,XPContainer:2,GoldContainer:3,Player:4,BotPlayer:5};var A=class extends E{constructor(t){var e,r;super(),this.entityType=(e=t==null?void 0:t.getEntityType())!=null?e:c.None,this.entityID=(r=t==null?void 0:t.getID())!=null?r:0}getFlexibleSize(){let t=0;return t+=4,t}onSerialize(t){t.writeUint16(this.entityID)}onDeserialize(t){this.entityID=t.readUint16()}};var D=class extends A{constructor(t){var s;super(t);let e=(s=t==null?void 0:t.healthComponent)!=null?s:void 0,r=(e?e.currentHP/e.maxHPProvider():0)*100;this.hpPer=Math.round(r)}getFlexibleSize(){let t=super.getFlexibleSize();return t+=1,t}onSerialize(t){super.onSerialize(t),t.writeUint8(this.hpPer)}onDeserialize(t){super.onDeserialize(t),this.hpPer=t.readUint8()}};var l=class i extends E{static Zero(){return new i(0,0)}static One(){return new i(1,1)}static Up(){return new i(0,1)}static Down(){return new i(0,-1)}static Left(){return new i(-1,0)}static Right(){return new i(1,0)}constructor(t=0,e=0){super(),this.x=t,this.y=e}set(t,e){this.x=t,this.y=e}getFlexibleSize(){let t=0;return t+=4,t+=4,t}onSerialize(t){t.writeFloat32(this.x),t.writeFloat32(this.y)}onDeserialize(t){this.x=t.readFloat32(),this.y=t.readFloat32()}getMagnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}getSqrMagnitude(){return this.x*this.x+this.y*this.y}normalize(){let t=this.getSqrMagnitude();if(t===0)return this;let e=1/Math.sqrt(t);return this.x*=e,this.y*=e,this}add(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}multiply(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t,this.y/=t,this}static equals(t,e){return t.x===e.x&&t.y===e.y}static normalize(t){let e=t.getSqrMagnitude();if(e===0)return new i(0,0);let r=1/Math.sqrt(e);return new i(t.x*r,t.y*r)}static add(t,e){return new i(t.x+e.x,t.y+e.y)}static subtract(t,e){return new i(t.x-e.x,t.y-e.y)}static multiply(t,e){return new i(t.x*e,t.y*e)}static divide(t,e){return new i(t.x/e,t.y/e)}static dot(t,e){return t.x*e.x+t.y*e.y}static cross(t,e){return t.x*e.y-t.y*e.x}};var d=class extends D{constructor(t){var e;super(t),this.position=(e=t==null?void 0:t.position)!=null?e:new l}getFlexibleSize(){let t=super.getFlexibleSize();return t+=this.position.getFlexibleSize()+g(),t}onSerialize(t){super.onSerialize(t),t.writeArrayBuffer(this.position.serialize())}onDeserialize(t){super.onDeserialize(t),this.position=new l().deserialize(t.readArrayBuffer())}};var S=class extends E{constructor(t){var e,r;super(),this.entityType=(e=t==null?void 0:t.getEntityType())!=null?e:c.None,this.entityID=(r=t==null?void 0:t.getID())!=null?r:0}getFlexibleSize(){let t=0;return t+=4,t}onSerialize(t){t.writeUint16(this.entityID)}onDeserialize(t){this.entityID=t.readUint16()}};var U=class extends S{constructor(t){var e,r;super(t),this.position=(e=t==null?void 0:t.position)!=null?e:new l,this.name=(r=t==null?void 0:t.nickname)!=null?r:""}getFlexibleSize(){let t=super.getFlexibleSize();return t+=this.position.getFlexibleSize()+g(),t+=F(this.name),t}onSerialize(t){super.onSerialize(t),t.writeArrayBuffer(this.position.serialize()),t.writeStringUTF8(this.name)}onDeserialize(t){super.onDeserialize(t),this.position=new l().deserialize(t.readArrayBuffer()),this.name=t.readStringUTF8()}};var N={None:0,Up:1,Down:2,Left:3,Right:4,UpLeft:5,UpRight:6,DownLeft:7,DownRight:8};var w=class extends S{constructor(t){var e;super(t),this.position=(e=t==null?void 0:t.position)!=null?e:new l}getFlexibleSize(){let t=super.getFlexibleSize();return t+=this.position.getFlexibleSize()+g(),t}onSerialize(t){super.onSerialize(t),t.writeArrayBuffer(this.position.serialize())}onDeserialize(t){super.onDeserialize(t),this.position=new l().deserialize(t.readArrayBuffer())}};var L=class extends d{constructor(t){var o,n,a,u,m,C;super(t),this.entityType=c.Player,this.exp=(n=(o=t==null?void 0:t.levelComponent)==null?void 0:o.xpAmount)!=null?n:0,this.score=(a=t==null?void 0:t.score)!=null?a:0;let e=(u=t==null?void 0:t.attackComponent)!=null?u:void 0,r=((m=e==null?void 0:e.getRemainAttackCooltimePer())!=null?m:0)*100;this.remainAtkCoolPer=Math.round(r);let s=((C=e==null?void 0:e.getChargingPer())!=null?C:0)*100;this.chargingPer=Math.round(s)}getFlexibleSize(){let t=super.getFlexibleSize();return t+=2,t+=2,t+=2,t+=2,t}onSerialize(t){super.onSerialize(t),t.writeUint16(this.exp),t.writeUint16(this.score),t.writeUint16(this.remainAtkCoolPer),t.writeUint16(this.chargingPer)}onDeserialize(t){super.onDeserialize(t),this.exp=t.readUint16(),this.score=t.readUint16(),this.remainAtkCoolPer=t.readUint16(),this.chargingPer=t.readUint16()}};var z=class z{constructor(){throw new Error("EntityDataFactory is a static class and cannot be instantiated")}static on(t,e,r){z.entityStaticDataFactories[t]=e,z.entityDynamicDataFactories[t]=r}static createEntityStaticData(t,e){if(t==c.None)throw new Error("Entity type is not set");let r=z.entityStaticDataFactories[t];return r==null?null:new r(e)}static createEntityDynamicData(t,e){if(t==c.None)throw new Error("Entity type is not set");let r=z.entityDynamicDataFactories[t];return r==null?null:new r(e)}};b(z,"entityStaticDataFactories",{}),b(z,"entityDynamicDataFactories",{});var p=z;p.on(c.XPObject,w,null);p.on(c.XPContainer,w,D);p.on(c.GoldContainer,w,D);p.on(c.Player,U,L);p.on(c.BotPlayer,U,d);var gt={ERROR:"\x1B[31m",WARN:"\x1B[33m",INFO:"\x1B[36m",DEBUG:"\x1B[90m",RESET:"\x1B[0m"},_={ERROR:0,WARN:1,INFO:2,DEBUG:3},v={DEVELOPMENT:"development",PRODUCTION:"production",MASTER:"master"},ht={[v.DEVELOPMENT]:_.DEBUG,[v.PRODUCTION]:_.INFO,[v.MASTER]:_.ERROR},ft=class{constructor(){this.currentLevel=ht[v.DEVELOPMENT]}setMode(t){ht.hasOwnProperty(t)!==!1&&(this.currentLevel=ht[t])}getTimestamp(){return new Date().toISOString()}formatMessage(t,e,r){let s=this.getTimestamp(),o=gt[t]||"",n=gt.RESET;return`${o}[${s}] [${t}] [${e}] ${r}${n}`}log(t,e,r){_[t]>this.currentLevel||console.log(this.formatMessage(t,e,r))}error(t,e){this.log("ERROR",t,e)}warn(t,e){this.log("WARN",t,e)}info(t,e){this.log("INFO",t,e)}debug(t,e){this.log("DEBUG",t,e)}},Tt=new ft;var ut=class i{static direction(){let t=Math.random()*2*Math.PI;return new l(Math.cos(t),Math.sin(t))}static insideUnitCircle(){return i.direction().multiply(Math.random())}static range(t,e){return Math.random()*(e-t)+t}static rangeInt(t,e){return Math.floor(i.range(t,e))}};var h=class extends E{constructor(){super()}getPacketID(){throw new Error("Abstract method 'getPacketID' must be implemented")}getFlexibleSize(){let t=0;return t+=1,t}onSerialize(t){t.writeUint8(this.getPacketID())}onDeserialize(t){t.readUint8()}};var G=class{constructor(){}handle(t){throw new Error("Abstract method 'handle' must be implemented")}};var I=class{constructor(){throw new Error("PacketManager is a static class and cannot be instantiated")}static on(t,e,r){this.factories[t]=e,this.handlers[t]=r}static createPacket(t,e){let r=this.factories[t];if(r===void 0)throw new Error(`Factory for packetID ${t} not found`);let s=new r;return s.deserialize(e),s}static createHandler(t,...e){let r=this.handlers[t];if(r===void 0)throw new Error(`Handler for packetID ${t} not found`);return new r(...this.handlerArgs,...e)}static injectHandlerArgs(...t){this.handlerArgs=t}};b(I,"factories",{}),b(I,"handlers",{}),b(I,"handlerArgs",[]);var f={Message:0,Vector:1,S2C_UpdateWorld:2,C2S_EnterWorldRequest:3,S2C_EnterWorldResponse:4,C2S_MoveInput:5,C2S_StartAttackCharging:6,C2S_FinishAttackCharging:7,C2S_BuyItem:8,S2C_CharacterLevelUp:9,C2S_CharacterStatLevelUpRequest:10,S2C_CharacterStatLevelUpResponse:11,S2C_UpdateRankingPacket:12};var W=class extends h{constructor(t=0){super(),this.buyItemId=t}getPacketID(){return f.C2S_BuyItem}getFlexibleSize(){let t=super.getFlexibleSize();return t+=1,t}onSerialize(t){super.onSerialize(t),t.writeUint8(this.buyItemId)}onDeserialize(t){super.onDeserialize(t),this.buyItemId=t.readUint8()}};var P={WEIGHT:0,MAX_HP:1,ATK_COOLTIME:2,MAX_CHARGE_LEN:3,MOVE_SPEED:4,AUTO_HEAL:5},At={[P.WEIGHT]:100,[P.MAX_HP]:1e5,[P.ATK_COOLTIME]:1,[P.MAX_CHARGE_LEN]:10,[P.MOVE_SPEED]:1,[P.AUTO_HEAL]:0},T={Type:P,DefaultValue:At};function M(i){if(i==null)return null;let t=String(i).trim().replace(",","."),e=Number.parseFloat(t);return Number.isFinite(e)?e:null}function R(i){if(i==null)return null;let t=Number.parseInt(String(i).trim(),10);return Number.isFinite(t)?t:null}function B(i){if(i==null)return null;let t=String(i).trim().toLowerCase();return t==="true"||t==="1"?!0:t==="false"||t==="0"?!1:null}var y=class{constructor(){this.id=0,this.name="",this.desc="",this.dict={}}init(t,e){this.id=t,this.dict=e||{},this.name=this.getDictValue("Name",""),this.desc=this.getDictValue("Desc","")}hasDict(t){return Object.prototype.hasOwnProperty.call(this.dict,t)}getDictValue(t,e=""){return this.dict[t]}getDictValueInt(t,e=0){let r=R(this.dict[t]);return Number.isFinite(r)?r:e}getDictValueFloat(t,e=0){let r=M(this.dict[t]);return Number.isFinite(r)?r:e}getDictValueBool(t,e=!1){let r=B(this.dict[t]);return r==null?e:!!r}getDictValueArray(t,e=[]){let r=this.dict[t];if(r==null)return e;if(Array.isArray(r))return r;if(typeof r=="string"){try{let o=JSON.parse(r);if(Array.isArray(o))return o}catch(o){}let s=r.split(",").map(o=>o.trim()).filter(o=>o.length>0);if(s.length>0)return s}return e}static _ensureStore(){Object.prototype.hasOwnProperty.call(this,"items")||Object.defineProperty(this,"items",{value:new Map,writable:!0,enumerable:!1,configurable:!0})}static get(t){return this._ensureStore(),this.items.get(t)}static getAll(){return this._ensureStore(),this.items}static getWhere(t){this._ensureStore();let e=[];for(let r of this.items.values())(!t||t(r))&&e.push(r);return e}static async load(t,e=!0){let r=this;r._ensureStore();let s;try{let o=t.charCodeAt(0)===65279?t.slice(1):t;s=JSON.parse(o)}catch(o){throw new Error(`[${r.name}] JSON parse error`)}e&&r.items.clear();for(let o in s){if(!Object.prototype.hasOwnProperty.call(s,o))continue;let n=Number.parseInt(o,10);if(!Number.isFinite(n))continue;let a=s[o],u=a;if(typeof a=="string")try{u=JSON.parse(a)}catch(C){throw new Error(`[${r.name}] Skip id=${n} (inner JSON parse error)`)}if(!u||typeof u!="object")throw new Error(`[${r.name}] Skip id=${n} (value is not an object)`);let m=new r;m.init(n,u),r.items.set(n,m)}}};var x={ADD_WEIGHT_PER:1,ADD_MAX_CHARGE_LEN_PER:2,ADD_MAX_HP_PER:3,ADD_MOVE_SPEED_PER:4,REDUCE_ATK_COOLTIME_PER:5,AUTO_HEAL:6},lt=class extends y{constructor(){super(),this.icon="",this.levelUpEffect="",this.maxLevel=0,this.levelValues=[]}init(t,e){super.init(t,e),this.icon=this.getDictValue("Icon",""),this.levelUpEffect=this.getDictValue("LevelUpEffect",""),this.maxLevel=this.getDictValueInt("MaxLevel",0),this.levelValues=this.getDictValue("LevelValues")}getLevelValue(t){if(t>this.maxLevel)throw new Error("Invalid level exception");return this.levelValues[t]}isPercentage(){return this.id!==x.AUTO_HEAL}static getByStatType(t){switch(t){case T.Type.WEIGHT:return this.get(x.ADD_WEIGHT_PER);case T.Type.MAX_HP:return this.get(x.ADD_MAX_HP_PER);case T.Type.ATK_COOLTIME:return this.get(x.REDUCE_ATK_COOLTIME_PER);case T.Type.AUTO_HEAL:return this.get(x.AUTO_HEAL);case T.Type.MAX_CHARGE_LEN:return this.get(x.ADD_MAX_CHARGE_LEN_PER);case T.Type.MOVE_SPEED:return this.get(x.ADD_MOVE_SPEED_PER);default:return null}}};var X=class extends h{constructor(t=""){super(),this.message=t}getPacketID(){return f.Message}getFlexibleSize(){let t=super.getFlexibleSize();return t+=F(this.message),t}onSerialize(t){super.onSerialize(t),t.writeStringUTF8(this.message)}onDeserialize(t){super.onDeserialize(t),this.message=t.readStringUTF8()}};var q=class extends h{constructor(t=new l){super(),this.vector=t}getPacketID(){return f.Vector}getFlexibleSize(){let t=super.getFlexibleSize();return t+=this.vector.getFlexibleSize()+g(),t}onSerialize(t){super.onSerialize(t),t.writeArrayBuffer(this.vector.serialize())}onDeserialize(t){super.onDeserialize(t),this.vector=new l().deserialize(t.readArrayBuffer())}};var $=class extends h{constructor(t=0,e=null,r=[],s=[],o=[]){super(),this.elapsedMS=t,this.appearedEntityStaticDataSize=0,this.appearedEntityStaticDatas=[],r.forEach(n=>{let a=this._createEntityData(e,n,p.createEntityStaticData);a!=null&&(this.appearedEntityStaticDataSize+=a.dataSize,this.appearedEntityStaticDatas.push(a.entityData))}),this.nearbyEntityDynamicDataSize=0,this.nearbyEntityDynamicDatas=[],s.forEach(n=>{let a=this._createEntityData(e,n,p.createEntityDynamicData);a!=null&&(this.nearbyEntityDynamicDataSize+=a.dataSize,this.nearbyEntityDynamicDatas.push(a.entityData))}),this.disappearedEntityIDs=[],o.forEach(n=>{this.disappearedEntityIDs.push(n.entityID)})}_createEntityData(t,e,r){let s=e==t?c.Player:e.getEntityType(),o=r(s,e);return o==null?null:{dataSize:o.getFlexibleSize()+g()+1,entityData:o}}getPacketID(){return f.S2C_UpdateWorld}getFlexibleSize(){let t=super.getFlexibleSize();return t+=2,t+=this.appearedEntityStaticDataSize+2,t+=this.nearbyEntityDynamicDataSize+2,t+=this.disappearedEntityIDs.length*4+2,t}onSerialize(t){super.onSerialize(t),t.writeUint16(this.elapsedMS),this._writeEntityDatas(t,this.appearedEntityStaticDatas),this._writeEntityDatas(t,this.nearbyEntityDynamicDatas),t.writeUint16(this.disappearedEntityIDs.length);for(let e=0;e<this.disappearedEntityIDs.length;++e)t.writeUint32(this.disappearedEntityIDs[e])}onDeserialize(t){super.onDeserialize(t),this.elapsedMS=t.readUint16(),this._readEntityDatas(t,p.createEntityStaticData,this.appearedEntityStaticDatas),this._readEntityDatas(t,p.createEntityDynamicData,this.nearbyEntityDynamicDatas);let e=t.readUint16();for(let r=0;r<e;++r)this.disappearedEntityIDs.push(t.readUint32())}_writeEntityDatas(t,e){t.writeUint16(e.length);for(let r=0;r<e.length;++r){let s=e[r];t.writeUint8(s.entityType),t.writeArrayBuffer(s.serialize())}}_readEntityDatas(t,e,r){let s=t.readUint16();for(let o=0;o<s;++o){let n=t.readUint8(),a=e(n,null);if(a==null)return;a.deserialize(t.readArrayBuffer()),a.entityType=n,r.push(a)}}};var j=class extends h{constructor(t){super(),this.nickname=t}getPacketID(){return f.C2S_EnterWorldRequest}getFlexibleSize(){let t=super.getFlexibleSize();return t+=F(this.nickname),t}onSerialize(t){super.onSerialize(t),t.writeStringUTF8(this.nickname)}onDeserialize(t){super.onDeserialize(t),this.nickname=t.readStringUTF8()}};var K=class extends h{constructor(t=0){super(),this.entityID=t}getPacketID(){return f.S2C_EnterWorldResponse}getFlexibleSize(){let t=super.getFlexibleSize();return t+=4,t}onSerialize(t){super.onSerialize(t),t.writeUint32(this.entityID)}onDeserialize(t){super.onDeserialize(t),this.entityID=t.readUint32()}};var J=class extends h{constructor(t=N.None){super(),this.moveInput=t}getPacketID(){return f.C2S_MoveInput}getFlexibleSize(){let t=super.getFlexibleSize();return t+=1,t}onSerialize(t){super.onSerialize(t),t.writeUint8(this.moveInput)}onDeserialize(t){super.onDeserialize(t),this.moveInput=t.readUint8()}};var Z=class extends h{constructor(){super()}getPacketID(){return f.C2S_StartAttackCharging}getFlexibleSize(){return super.getFlexibleSize()}onSerialize(t){super.onSerialize(t)}onDeserialize(t){super.onDeserialize(t)}};var Q=class extends h{constructor(t=l.Zero()){super(),this.direction=t}getPacketID(){return f.C2S_FinishAttackCharging}getFlexibleSize(){let t=super.getFlexibleSize();return t+=this.direction.getFlexibleSize()+g(),t}onSerialize(t){super.onSerialize(t),t.writeArrayBuffer(this.direction.serialize())}onDeserialize(t){super.onDeserialize(t),this.direction=new l().deserialize(t.readArrayBuffer())}};var Y=class extends h{constructor(t=0,e=0){super(),this.currentLevel=t,this.currentStatPoint=e}getPacketID(){return f.S2C_CharacterLevelUp}getFlexibleSize(){let t=super.getFlexibleSize();return t+=1,t+=1,t}onSerialize(t){super.onSerialize(t),t.writeUint8(this.currentLevel),t.writeUint8(this.currentStatPoint)}onDeserialize(t){super.onDeserialize(t),this.currentLevel=t.readUint8(),this.currentStatPoint=t.readUint8()}};var H=class extends h{constructor(t=x.ADD_WEIGHT_PER,e=0,r=0){super(),this.statType=t,this.statLevel=e,this.statPoint=r}getPacketID(){return f.S2C_CharacterStatLevelUpResponse}getFlexibleSize(){let t=super.getFlexibleSize();return t+=1,t+=1,t+=1,t}onSerialize(t){super.onSerialize(t),t.writeUint8(this.statType),t.writeUint8(this.statLevel),t.writeUint8(this.statPoint)}onDeserialize(t){super.onDeserialize(t),this.statType=t.readUint8(),this.statLevel=t.readUint8(),this.statPoint=t.readUint8()}};var tt=class extends h{constructor(t=[]){super(),this.rankingPlayerIds=[],this.rankingPlayerScores=[],t.forEach(e=>{this.rankingPlayerIds.push(e.entityID),this.rankingPlayerScores.push(e.score)})}getPacketID(){return f.S2C_UpdateRankingPacket}getFlexibleSize(){let t=super.getFlexibleSize();return t+=2,t+=this.rankingPlayerIds.length*4,t}onSerialize(t){super.onSerialize(t),t.writeUint16(this.rankingPlayerIds.length);for(let e=0;e<this.rankingPlayerIds.length;++e)t.writeUint16(this.rankingPlayerIds[e]),t.writeUint16(this.rankingPlayerScores[e])}onDeserialize(t){super.onDeserialize(t);let e=t.readUint16();for(let r=0;r<e;++r){let s=t.readUint16(),o=t.readUint16();this.rankingPlayerIds.push(s),this.rankingPlayerScores.push(o)}}};var et=class extends h{constructor(t=x.ADD_WEIGHT_PER){super(),this.statLevelUpType=t}getPacketID(){return f.C2S_CharacterStatLevelUpRequest}getFlexibleSize(){let t=super.getFlexibleSize();return t+=1,t}onSerialize(t){super.onSerialize(t),t.writeUint8(this.statLevelUpType)}onDeserialize(t){super.onDeserialize(t),this.statLevelUpType=t.readUint8()}};var ct=class extends y{constructor(){super(),this.level=0,this.requiredXP=0}init(t,e){super.init(t,e),this.level=this.getDictValueInt("Level",0),this.requiredXP=this.getDictValueInt("RequiredXP",0)}};var pt=class extends y{constructor(){super(),this.price=0,this.ability={}}init(t,e){super.init(t,e),this.price=this.getDictValueInt("Price"),this.ability=this.getDictValue("Ability")}getAbilityValue(t,e=""){return this.ability[t]}getAbilityValueInt(t,e=0){let r=R(this.ability[t]);return Number.isFinite(r)?r:e}getAbilityValueFloat(t,e=0){let r=M(this.ability[t]);return Number.isFinite(r)?r:e}getAbilityValueBool(t,e=!1){let r=B(this.ability[t]);return r==null?e:!!r}};return It(Lt);})();
//# sourceMappingURL=SharedBundle.js.map
